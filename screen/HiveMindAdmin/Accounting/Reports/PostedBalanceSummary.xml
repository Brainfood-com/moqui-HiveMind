<?xml version="1.0" encoding="UTF-8"?>
<!--
This is free and unencumbered software released into the public domain.
For specific language governing permissions and limitations refer to
the LICENSE.md file or http://unlicense.org
-->
<screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-1.5.xsd"
        default-menu-include="false">

    <parameter name="organizationPartyId" required="true"/>
    <parameter name="fromDate"/>
    <parameter name="thruDate"/>
    <parameter name="timePeriodId"/>

    <transition name="PostedBalanceSummaryExport.csv">
        <default-response url="."><parameter name="renderMode" value="csv"/>
            <parameter name="pageNoLimit" value="true"/><parameter name="lastStandalone" value="true"/></default-response>
    </transition>
    <transition name="PostedBalanceSummaryExport.xml">
        <default-response url="."><parameter name="renderMode" value="xml"/>
            <parameter name="pageNoLimit" value="true"/><parameter name="lastStandalone" value="true"/></default-response>
    </transition>

    <actions>
        <service-call name="mantle.ledger.LedgerServices.find#PartyAcctgPreference" out-map="context"
                in-map="[organizationPartyId:organizationPartyId]"/>

        <entity-find entity-name="mantle.ledger.report.GlAccountOrgTimePeriodDetail" list="resultList">
            <econdition field-name="organizationPartyId"/>
            <econdition field-name="fromDate" operator="greater-equals" from="fromDate" ignore-if-empty="true"/>
            <econdition field-name="thruDate" operator="less-equals" from="thruDate" ignore-if-empty="true"/>
            <econdition field-name="timePeriodId" ignore-if-empty="true"/>
            <order-by field-name="accountCode"/>
        </entity-find>
    </actions>
    <widgets>
        <container>
            <link url="PostedBalanceSummaryExport.csv" text="Get as CSV" target-window="_blank" expand-transition-url="false"/>
            <link url="PostedBalanceSummaryExport.xml" text="Get as XML" target-window="_blank" expand-transition-url="false"/>
        </container>
        <form-list name="ResultList" skip-form="true" list="resultList">
            <row-actions>
                <entity-find-one entity-name="moqui.basic.Enumeration" value-field="classEnum">
                    <field-map field-name="enumId" from="glAccountClassEnumId"/>
                </entity-find-one>
            </row-actions>
            <field name="periodName"><default-field><display/></default-field></field>
            <field name="fromDate"><default-field><display/></default-field></field>
            <field name="thruDate"><default-field><display/></default-field></field>
            <field name="accountCode"><default-field title="Acct Code"><display/></default-field></field>
            <field name="accountName"><default-field><display text="${accountName} (${classEnum.description})"/></default-field></field>
            <field name="postedDebits"><default-field><display currency-unit-field="partyAcctgPreference?.baseCurrencyUomId"/></default-field></field>
            <field name="postedCredits"><default-field><display currency-unit-field="partyAcctgPreference?.baseCurrencyUomId"/></default-field></field>
            <field name="beginningBalance"><default-field><display currency-unit-field="partyAcctgPreference?.baseCurrencyUomId"/></default-field></field>
            <field name="endingBalance"><default-field><display currency-unit-field="partyAcctgPreference?.baseCurrencyUomId"/></default-field></field>
            <field name="isClosed"><default-field><display/></default-field></field>
        </form-list>
    </widgets>
</screen>
